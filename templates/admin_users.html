{{define "content"}}
<div class="admin-container">
    <div class="admin-header">
        <h1>Gestion de Usuarios</h1>
        <div class="admin-nav">
            <a href="/admin" class="btn btn-secondary">Dashboard</a>
            <a href="/admin/users" class="btn btn-primary">Usuarios</a>
            <a href="/admin/filters" class="btn btn-secondary">Filtros</a>
            <a href="/admin/logs" class="btn btn-secondary">Logs</a>
        </div>
    </div>

    {{if .PendingUsers}}
    <section class="admin-section">
        <h2>Usuarios Pendientes ({{len .PendingUsers}})</h2>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Nomina</th>
                    <th>Nombre</th>
                    <th>Departamento</th>
                    <th>Fecha Registro</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody hx-target="closest tr" hx-swap="outerHTML">
                {{range .PendingUsers}}
                <tr id="pending-{{.ID}}">
                    <td>{{.Nomina}}</td>
                    <td>{{.Nombre}}</td>
                    <td>{{.Departamento.String}}</td>
                    <td>{{.CreatedAt}}</td>
                    <td class="actions">
                        <button hx-post="/admin/approve/{{.ID}}"
                                class="btn btn-sm btn-success">Aprobar</button>
                        <button hx-post="/admin/reject/{{.ID}}"
                                hx-confirm="Rechazar a este usuario?"
                                class="btn btn-sm btn-danger">Rechazar</button>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </section>
    {{end}}

    <section class="admin-section">
        <h2>Todos los Usuarios ({{len .AllUsers}})</h2>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Nomina</th>
                    <th>Nombre</th>
                    <th>Departamento</th>
                    <th>Estado</th>
                    <th>Rol</th>
                    <th>Registro</th>
                </tr>
            </thead>
            <tbody>
                {{range .AllUsers}}
                <tr>
                    <td>{{.Nomina}}</td>
                    <td>{{.Nombre}}</td>
                    <td>{{.Departamento.String}}</td>
                    <td>
                        {{if eq .Approved 1}}
                        <span class="status-badge status-approved">Aprobado</span>
                        {{else}}
                        <span class="status-badge status-pending">Pendiente</span>
                        {{end}}
                    </td>
                    <td>
                        {{if eq .IsAdmin 1}}
                        <span class="role-badge role-admin">Admin</span>
                        {{else}}
                        <span class="role-badge role-user">Usuario</span>
                        {{end}}
                    </td>
                    <td>{{.CreatedAt}}</td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </section>
</div>
{{end}}

{{template "base" .}}
